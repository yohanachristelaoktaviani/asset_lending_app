<% provide(:title, "Asset Return") %>

<div class="form">
<br>

<div class="container9 mb-4">
<h1 class="pb-0 mb-2">Return Item</h1>

<% if flash[:success] %>
<div class="alert alert-success">
  <%= flash[:success] %>
</div>
<% end %>

<% if flash[:errors] %>
<div class="alert alert-danger">
  <%= flash[:errors] %>
</div>
<% end %>

<div class="table-responsive w-100 mb-5">
<table class="table borderless w-100 mb-5">
  <tr>
  <td><%= link_to 'Export Data', export_return_asset_return_items_path(format: :csv), id: 'export-csv-link',  class: 'button-export btn btn-info text-light', :format => 'csv', download: 'export_data.csv' %></td>
    <td>
      <div class="table-container">
        <%= form_tag asset_return_items_path, method: 'get' do %>
            <div class="input-group mx-1 search">
              <div class="container-icon">
                <span class="search-icon"><i class="fa fa-search"></i></span>
              </div>
              <%= text_field_tag :search, params[:search], placeholder: 'Type here...', class: "form-control search-box" %>
              <span class="input-group-btn">
                <%= submit_tag "Search", class: "btn btn-secondary search-button" %>
              </span>
              </div>
        <% end %>
    </td>
  </tr>
</table>



<table class="table table-bordered table-striped table-hover w-100 center">
  <thead class="thead">
    <tr>
      <th class="th">Return ID</th>
      <th class="th">Item</th>
      <th class="th">Item ID</th>
      <th class="th">User</th>
      <th class="th">Actual Return Date</th>
      <th class="th">Actual Item Condition</th>
      <th class="th">Return Status</th>
      <th class="th">Admin</th>
      <th class="th">Status</th>
    </tr>
  </thead>
  <tbody>
  <% @return_items.each do |retur| %>
      <tr>
          <td><%= link_to retur.asset_return.code, asset_return_item_path(retur) %></td>
          <td><%= retur.item.name %></td>
          <td><%= retur.item.code %></td>
          <td><%= retur.asset_return.user.name %></td>
          <td><%= retur.asset_return.actual_return_datetime.localtime.strftime("%Y-%m-%d %H:%M:%S") %></td>
          <td>
            <% if retur.item.condition == "good" %>
              <span class="badge rounded-pill bg-success"><%= retur.item.condition %></span>
            <% elsif retur.item.condition == "damage" %>
              <span class="badge rounded-pill bg-warning"><%= retur.item.condition %></span>
            <% elsif retur.item.condition == "unusable" %>
              <span class="badge rounded-pill bg-danger"><%= retur.item.condition %></span>
            <% end %>
          </td>
          <td>
            <% if retur.asset_return.return_status == "on time" %>
              <span class="badge rounded-pill bg-success"><%= retur.asset_return.return_status %></span>
            <% elsif retur.asset_return.return_status == "late" %>
              <span class="badge rounded-pill bg-danger"><%= retur.asset_return.return_status %></span>
            <% end %>
          </td>
          <td>
            <%=
              if retur.admin.present?
                retur.admin.name
              else
                ""
              end
            %>
          </td>
          <td><%= retur.status %></td>
      </tr>
      <% end %>

  </tbody>
</table>

</div>
<%= paginate @return_items, :window => 3 %>
</div>
</div>

